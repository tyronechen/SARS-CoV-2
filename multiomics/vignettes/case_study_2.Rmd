---
title: "Case study 2"
output:
  rmarkdown::html_vignette:
    toc: true
    toc_depth: 2
    number_sections: true
vignette: >
  %\VignetteIndexEntry{Case study 2}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r init, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r global-options, include=FALSE}
knitr::opts_chunk$set(fig.width=12, fig.height=8, fig.path='figs/',
                      echo=TRUE, warning=FALSE, message=FALSE)
```

Copyright (c) 2020 <a href="https://orcid.org/0000-0002-9207-0385">Tyrone Chen <img alt="ORCID logo" src="https://info.orcid.org/wp-content/uploads/2019/11/orcid_16x16.png" width="16" height="16" /></a>, <a href="https://orcid.org/0000-0002-0827-866X">Melcy Philip <img alt="ORCID logo" src="https://info.orcid.org/wp-content/uploads/2019/11/orcid_16x16.png" width="16" height="16" /></a>, <a href="https://orcid.org/0000-0003-3923-1116">Kim-Anh LÃª Cao <img alt="ORCID logo" src="https://info.orcid.org/wp-content/uploads/2019/11/orcid_16x16.png" width="16" height="16" /></a>, <a href="https://orcid.org/0000-0003-0181-6258">Sonika Tyagi <img alt="ORCID logo" src="https://info.orcid.org/wp-content/uploads/2019/11/orcid_16x16.png" width="16" height="16" /></a>

Code in this package and git repository [https://gitlab.com/tyagilab/sars-cov-2/](https://gitlab.com/tyagilab/sars-cov-2/) is provided under a [MIT license](https://opensource.org/licenses/MIT). This documentation is provided under a [CC-BY-3.0 AU license](https://creativecommons.org/licenses/by/3.0/au/).

[Visit our lab website here.](https://bioinformaticslab.erc.monash.edu/) Contact Sonika Tyagi at [sonika.tyagi@monash.edu](mailto:sonika.tyagi@monash.edu).

# Index

- [Introduction](introduction.html)
- [Case study 1](case_study_1.html)
- [Case study 2](case_study_2.html)

# Running the script

Load the library.

```{r setup}
library(multiomics)
```

A script to reproduce our analysis for case study 2 is shown. [You can also download this here](https://gitlab.com/tyagilab/sars-cov-2/-/raw/master/src/case_study_2/example.sh). This may take up to a few days to run.

```
Rscript ../run_pipeline.R \
   ../../data/case_study_2/classes_diablo.tsv \
   --classes_secondary NA \
   --dropna_classes FALSE \
   --dropna_prop 0 \
   --data ../../../data/case_study_2/data_lipidomics.tsv ../../data/case_study_2/data_metabolomics.tsv ../../data/case_study_2/data_proteomics.tsv ../../data/case_study_2/data_transcriptomics_imputed_all.tsv \
   --data_names lipidome metabolome proteome transcriptome \
   --force_unique FALSE \
   --mappings NA \
   --ncpus 16 \
   --diablocomp 0 \
   --linkage 0.1 \
   --diablo_keepx 5 6 7 8 9 10 30 \
   --icomp 0 \
   --pcomp 10 \
   --plsdacomp 2 \
   --splsdacomp 2 \
   --splsda_keepx 5 6 7 8 9 10 30 \
   --dist_plsda centroids.dist \
   --dist_splsda centroids.dist \
   --dist_diablo centroids.dist \
   --contrib max \
   --outfile_dir ../../results/case_study_2/EXAMPLE/ \
   --rdata RData.RData \
   --plot Rplots.pdf \
   --args Rscript.sh
```

# Input data

## Biological context

## Summary

The data used as input to this pipeline available in gitlab:

- [biological class information]()
- [lipidome]()
- [metabolome]()
- [proteome]()
- [transcriptome]()

## Metadata

The class information is available as a vector:

## Data

The lipidome, metabolome, proteome and transcriptome data have 100 matched samples and an arbitrary number of features.

# Data quality control

## Accounting for missing values

## Accounting for unwanted variation

# Single omics analyses

## Parameter tuning

## Diagnostic plots

## Results

# Multi omics analyses

## Parameter tuning

## Diagnostic plots

## Results

# Output data

Files output by the pipeline include:

- a `pdf` file of all plots generated by the pipeline
- tab-separated `txt` files containing feature contribution weights to each biological class
- tab-separated `txt` file containing correlations between each omics data block

[A `RData` object with all input and output is available in the git repository.](https://gitlab.com/tyagilab/sars-cov-2/-/blob/master/results/case_study_2/RData.RData) This is not included directly in the `multiomics` package because of size constraints, and includes data from four omics datasets.

# Acknowledgements

[Please refer to introduction.](introduction.html)

# References

[Please refer to introduction.](introduction.html)
